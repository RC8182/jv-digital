<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Anem√≥metro ESP32</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Dashboard Anem√≥metro</h1>
            <nav class="tabs">
                <button class="tab-link active" data-tab="configuracion">Configuraci√≥n</button>
                <button class="tab-link" data-tab="diagnostico">Diagn√≥stico</button>
                <button class="tab-link" data-tab="alertas">Alertas</button>
                <button class="tab-link" onclick="openTab(event, 'logs')">Logs</button>
            </nav>
        </header>

        <div id="reboot-status-banner" class="reboot-banner"></div>

        <main>
            <div id="estado-tiempo-real" class="card estado-tiempo-real">
                <h2>Estado en Tiempo Real</h2>
                <div class="estado-grid">
                    <div class="estado-item">
                        <span class="icon-velocidad" title="Velocidad del viento">üí®</span>
                        <span id="velocidad-valor">--</span> <span class="unidad">m/s</span>
                        <div class="label">Velocidad</div>
                    </div>
                    <div class="estado-item">
                        <span class="icon-direccion" title="Direcci√≥n del viento">üß≠</span>
                        <span id="direccion-valor">--</span> <span class="unidad">¬∞</span>
                        <div class="label">Direcci√≥n</div>
                    </div>
                    <div class="estado-item">
                        <span class="icon-bateria" title="Bater√≠a principal">üîã</span>
                        <span id="bateria-valor">--</span> <span class="unidad">%</span>
                        <div class="label">Bater√≠a</div>
                    </div>
                    <div class="estado-item">
                        <span class="icon-voltaje" title="Voltaje">‚ö°</span>
                        <span id="voltaje-valor">--</span> <span class="unidad">mV</span>
                        <div class="label">Voltaje</div>
                    </div>
                    <div class="estado-item">
                        <span class="icon-modo" title="Modo actual">üåó</span>
                        <span id="modo-valor">--</span>
                        <div class="label">Modo</div>
                    </div>
                    <div class="estado-item">
                        <span class="icon-rssi" title="Se√±al RSSI">üì∂</span>
                        <span id="rssi-valor">--</span> <span class="unidad">dBm</span>
                        <div class="label">RSSI</div>
                    </div>
                    <div class="estado-item">
                        <span class="icon-timestamp" title="√öltima actualizaci√≥n">‚è∞</span>
                        <span id="timestamp-valor">--</span>
                        <div class="label">Actualizaci√≥n</div>
                    </div>
                </div>
            </div>

            <div id="configuracion" class="tab-content active">
                <div class="card">
                    <h2>Configuraci√≥n Actual (valores brutos)</h2>
                    <div id="current-config">
                        <p>Cargando configuraci√≥n...</p>
                    </div>
                </div>

                <div class="card">
                    <h2>Establecer Nueva Configuraci√≥n</h2>
                    <form id="config-form">
                        <div class="form-group">
                            <label for="wakeTime">Hora de Inicio del Modo D√≠a:</label>
                            <input type="time" id="wakeTime" name="wakeTime" pattern="[0-2][0-9]:[0-5][0-9]" value="07:55" required>
                            <small>Hora (HH:MM) en la que el anem√≥metro cambia a modo "d√≠a".</small>
                        </div>
                        <div class="form-group">
                            <label for="sleepTime">Hora de Inicio del Modo Noche:</label>
                            <input type="time" id="sleepTime" name="sleepTime" pattern="[0-2][0-9]:[0-5][0-9]" value="19:30" required>
                            <small>Hora (HH:MM) en la que el anem√≥metro cambia a modo "noche".</small>
                        </div>
                        <div class="form-group">
                            <label for="readDayMs">Intervalo Lectura (D√≠a, seg):</label>
                            <input type="number" id="readDayMs" name="readDayMs" min="1" value="5" required>
                            <small>Frecuencia de lectura BLE en modo d√≠a.</small>
                        </div>
                        <div class="form-group">
                            <label for="readNightMs">Intervalo Lectura (Noche, seg):</label>
                            <input type="number" id="readNightMs" name="readNightMs" min="1" value="60" required>
                            <small>Frecuencia de lectura BLE en modo noche.</small>
                        </div>
                        <div class="form-group">
                            <label for="sendDayMs">Intervalo Env√≠o (D√≠a, min):</label>
                            <input type="number" id="sendDayMs" name="sendDayMs" min="1" value="3" required>
                            <small>Frecuencia de env√≠o MQTT en modo d√≠a.</small>
                        </div>
                        <div class="form-group">
                            <label for="sendNightMs">Intervalo Env√≠o (Noche, min):</label>
                            <input type="number" id="sendNightMs" name="sendNightMs" min="1" value="60" required>
                            <small>Frecuencia de env√≠o MQTT en modo noche.</small>
                        </div>
                        <div class="form-group">
                            <label for="mqttKeepAliveS">MQTT Keep-Alive (seg):</label>
                            <input type="number" id="mqttKeepAliveS" name="mqttKeepAliveS" min="10" value="20" required>
                            <small>Intervalo del keep-alive de MQTT.</small>
                        </div>
                        <button type="submit" id="save-button">Guardar Configuraci√≥n</button>
                    </form>
                    <div id="message" class="message"></div>
                </div>

                <div class="card">
                    <h2>Mantenimiento</h2>
                    <p>El dispositivo se ha reiniciado <strong id="reset-count-valor">--</strong> veces.</p>
                    <p>Pone a cero el contador de reinicios del dispositivo. √ötil despu√©s de un mantenimiento o actualizaci√≥n.</p>
                    <button id="reset-counter-button" class="button-warning">Poner Contador a Cero</button>
                    <button id="reboot-button" class="button-danger">Reiniciar Dispositivo</button>
                </div>
            </div>

            <div id="diagnostico" class="tab-content">
                <div class="card">
                    <h2>Diagn√≥stico del Sistema</h2>
                    <button id="run-diagnostic-button">Ejecutar Diagn√≥stico</button>
                    <div id="diagnostic-output">
                        <p>Los resultados del diagn√≥stico aparecer√°n aqu√≠.</p>
                    </div>
                </div>
            </div>

            <div id="logs" class="tab-content">
                <div class="card">
                    <h2>Logs en Directo</h2>
                    <button id="get-status-button" class="button-small">Solicitar Estado/Logs Actuales</button>
                    <div id="logs-output" class="logs-container"></div>
                </div>
            </div>

            <div id="alertas" class="tab-content">
                <div class="card">
                    <h2>Alertas en Tiempo Real</h2>
                    <div id="alerts-container">
                        <p>Esperando alertas...</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js" defer></script>
</body>
</html> 